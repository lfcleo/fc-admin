import{aG as gt,b as de,J as Y,aH as be,Y as Ue,d as G,ac as Ne,aI as vt,aJ as wt,aE as Ge,u as pe,aK as yt,y as M,aL as bt,al as Ce,c as te,T as fe,ag as Ct,z as Qe,o as E,e as K,k as l,w as d,s as _,n as S,f as u,a0 as le,ay as ce,g as I,E as B,a2 as Ze,a as W,F as _e,aM as _t,aN as xt,aO as Ot,aP as Je,r as kt,aQ as Et,aR as $t,m as et,G as Ee,ax as $e,h as P,aS as St,aT as It,_ as ge,aC as ye,aD as ue,aU as Lt,j as tt,aV as st,I as it,aW as j,U as ot,aX as Ht,t as xe,aY as Xt,a1 as Mt,aZ as Yt,a_ as Wt,C as me,a$ as Pe,b0 as Tt,az as Rt,b1 as At,$ as Ut,M as Nt,a9 as Pt,b2 as ze,aa as Fe,b3 as at,A as oe,p as Le,q as He,v as Xe,l as N,S as zt}from"./index.Bw-HXdJa.js";import{a as Ft}from"./el-main.B07pfieo.js";import{b as Bt,E as Dt,a as qt}from"./el-form-item.DdTFErcb.js";/* empty css                  *//* empty css                 */import{E as jt}from"./el-alert.CuN-_INI.js";import{E as Vt}from"./el-progress.CDNSOGiL.js";import{S as Kt}from"./sortable.esm.C0-Qcoum.js";import{f as rt,a as nt}from"./constants.Dnj8X3EN.js";import{E as ne}from"./index.BD3XrQao.js";import{t as Me,d as Gt}from"./error.Cq9Fpw4b.js";import{a as Oe}from"./use-form-common-props.BgNKS3AW.js";import{i as Qt}from"./isEqual.Ckuk4erB.js";import{d as Zt}from"./debounce.RM8y6Bmx.js";import{E as Jt}from"./el-card.6quAyc34.js";import{E as es}from"./el-dialog.BBA-NIMO.js";import{E as ts}from"./el-row.BEUSs2Qz.js";import{E as ss}from"./el-col.DlOUmWKu.js";import{g as is}from"./uuid.D_VhYxgV.js";import{E as lt}from"./index.GJMPp4rU.js";import{u as ee}from"./auth.Br8NIlpK.js";import{E as os}from"./index.CTGuaza0.js";import"./castArray.BRNpEoYs.js";import"./index.C_MNJChK.js";import"./_Uint8Array.CtrPbzOU.js";import"./index.BHXUVmxi.js";import"./_initCloneObject.DfkDKOcq.js";import"./index.D9swEZg7.js";import"./index.DG3RyMHR.js";import"./scroll.q23gPQds.js";import"./vnode.C9FGNq6A.js";import"./aria.nkjrUMQ-.js";import"./focus-trap.BAcfioKZ.js";import"./validator.Bp9ffmHk.js";import"./event.BB_Ol6Sd.js";import"./isUndefined.DCTLXrZ8.js";import"./use-form-item.CTr4H4j6.js";import"./index.r5W6hzzQ.js";var as=1,rs=4;function Be(e){return Bt(e,as|rs)}var ns="Expected a function";function ke(e,s,t){var i=!0,o=!0;if(typeof e!="function")throw new TypeError(ns);return gt(t)&&(i="leading"in t?!!t.leading:i,o="trailing"in t?!!t.trailing:o),Zt(e,s,{leading:i,maxWait:s,trailing:o})}const ls=de({urlList:{type:Y(Array),default:()=>be([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Y(String)}}),cs={close:()=>!0,switch:e=>Ue(e),rotate:e=>Ue(e)},hs=["src","crossorigin"],us=G({name:"ElImageViewer"}),ps=G({...us,props:ls,emits:cs,setup(e,{expose:s,emit:t}){var i;const o=e,a={CONTAIN:{name:"contain",icon:Ne(vt)},ORIGINAL:{name:"original",icon:Ne(wt)}},{t:r}=Ge(),n=pe("image-viewer"),{nextZIndex:m}=yt(),g=M(),C=M([]),v=bt(),c=M(!0),p=M(o.initialIndex),x=Ce(a.CONTAIN),h=M({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),f=M((i=o.zIndex)!=null?i:m()),w=te(()=>{const{urlList:$}=o;return $.length<=1}),b=te(()=>p.value===0),O=te(()=>p.value===o.urlList.length-1),H=te(()=>o.urlList[p.value]),A=te(()=>[n.e("btn"),n.e("prev"),n.is("disabled",!o.infinite&&b.value)]),Q=te(()=>[n.e("btn"),n.e("next"),n.is("disabled",!o.infinite&&O.value)]),V=te(()=>{const{scale:$,deg:X,offsetX:L,offsetY:D,enableTransition:F}=h.value;let q=L/$,R=D/$;switch(X%360){case 90:case-270:[q,R]=[R,-q];break;case 180:case-180:[q,R]=[-q,-R];break;case 270:case-90:[q,R]=[-R,q];break}const re={transform:`scale(${$}) rotate(${X}deg) translate(${q}px, ${R}px)`,transition:F?"transform .3s":""};return x.value.name===a.CONTAIN.name&&(re.maxWidth=re.maxHeight="100%"),re});function U(){J(),t("close")}function ie(){const $=ke(L=>{switch(L.code){case ue.esc:o.closeOnPressEscape&&U();break;case ue.space:T();break;case ue.left:ve();break;case ue.up:ae("zoomIn");break;case ue.right:we();break;case ue.down:ae("zoomOut");break}}),X=ke(L=>{const D=L.deltaY||L.deltaX;ae(D<0?"zoomIn":"zoomOut",{zoomRate:o.zoomRate,enableTransition:!1})});v.run(()=>{ye(document,"keydown",$),ye(document,"wheel",X)})}function J(){v.stop()}function z(){c.value=!1}function se($){c.value=!1,$.target.alt=r("el.image.error")}function y($){if(c.value||$.button!==0||!g.value)return;h.value.enableTransition=!1;const{offsetX:X,offsetY:L}=h.value,D=$.pageX,F=$.pageY,q=ke(re=>{h.value={...h.value,offsetX:X+re.pageX-D,offsetY:L+re.pageY-F}}),R=ye(document,"mousemove",q);ye(document,"mouseup",()=>{R()}),$.preventDefault()}function k(){h.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function T(){if(c.value)return;const $=Lt(a),X=Object.values(a),L=x.value.name,F=(X.findIndex(q=>q.name===L)+1)%$.length;x.value=a[$[F]],k()}function Z($){const X=o.urlList.length;p.value=($+X)%X}function ve(){b.value&&!o.infinite||Z(p.value-1)}function we(){O.value&&!o.infinite||Z(p.value+1)}function ae($,X={}){if(c.value)return;const{minScale:L,maxScale:D}=o,{zoomRate:F,rotateDeg:q,enableTransition:R}={zoomRate:o.zoomRate,rotateDeg:90,enableTransition:!0,...X};switch($){case"zoomOut":h.value.scale>L&&(h.value.scale=Number.parseFloat((h.value.scale/F).toFixed(3)));break;case"zoomIn":h.value.scale<D&&(h.value.scale=Number.parseFloat((h.value.scale*F).toFixed(3)));break;case"clockwise":h.value.deg+=q,t("rotate",h.value.deg);break;case"anticlockwise":h.value.deg-=q,t("rotate",h.value.deg);break}h.value.enableTransition=R}return fe(H,()=>{Ct(()=>{const $=C.value[0];$!=null&&$.complete||(c.value=!0)})}),fe(p,$=>{k(),t("switch",$)}),Qe(()=>{var $,X;ie(),(X=($=g.value)==null?void 0:$.focus)==null||X.call($)}),s({setActiveItem:Z}),($,X)=>(E(),K(It,{to:"body",disabled:!$.teleported},[l(St,{name:"viewer-fade",appear:""},{default:d(()=>[_("div",{ref_key:"wrapper",ref:g,tabindex:-1,class:S(u(n).e("wrapper")),style:le({zIndex:f.value})},[_("div",{class:S(u(n).e("mask")),onClick:X[0]||(X[0]=ce(L=>$.hideOnClickModal&&U(),["self"]))},null,2),I(" CLOSE "),_("span",{class:S([u(n).e("btn"),u(n).e("close")]),onClick:U},[l(u(B),null,{default:d(()=>[l(u(Ze))]),_:1})],2),I(" ARROW "),u(w)?I("v-if",!0):(E(),W(_e,{key:0},[_("span",{class:S(u(A)),onClick:ve},[l(u(B),null,{default:d(()=>[l(u(_t))]),_:1})],2),_("span",{class:S(u(Q)),onClick:we},[l(u(B),null,{default:d(()=>[l(u(xt))]),_:1})],2)],64)),I(" ACTIONS "),_("div",{class:S([u(n).e("btn"),u(n).e("actions")])},[_("div",{class:S(u(n).e("actions__inner"))},[l(u(B),{onClick:X[1]||(X[1]=L=>ae("zoomOut"))},{default:d(()=>[l(u(Ot))]),_:1}),l(u(B),{onClick:X[2]||(X[2]=L=>ae("zoomIn"))},{default:d(()=>[l(u(Je))]),_:1}),_("i",{class:S(u(n).e("actions__divider"))},null,2),l(u(B),{onClick:T},{default:d(()=>[(E(),K(kt(u(x).icon)))]),_:1}),_("i",{class:S(u(n).e("actions__divider"))},null,2),l(u(B),{onClick:X[3]||(X[3]=L=>ae("anticlockwise"))},{default:d(()=>[l(u(Et))]),_:1}),l(u(B),{onClick:X[4]||(X[4]=L=>ae("clockwise"))},{default:d(()=>[l(u($t))]),_:1})],2)],2),I(" CANVAS "),_("div",{class:S(u(n).e("canvas"))},[(E(!0),W(_e,null,et($.urlList,(L,D)=>Ee((E(),W("img",{ref_for:!0,ref:F=>C.value[D]=F,key:L,src:L,style:le(u(V)),class:S(u(n).e("img")),crossorigin:$.crossorigin,onLoad:z,onError:se,onMousedown:y},null,46,hs)),[[$e,D===p.value]])),128))],2),P($.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ds=ge(ps,[["__file","image-viewer.vue"]]);const ct=tt(ds),ht=Symbol("uploadContextKey"),fs="ElUpload";class ms extends Error{constructor(s,t,i,o){super(s),this.name="UploadAjaxError",this.status=t,this.method=i,this.url=o}}function De(e,s,t){let i;return t.response?i=`${t.response.error||t.response}`:t.responseText?i=`${t.responseText}`:i=`fail to ${s.method} ${e} ${t.status}`,new ms(i,t.status,s.method,e)}function gs(e){const s=e.responseText||e.response;if(!s)return s;try{return JSON.parse(s)}catch{return s}}const vs=e=>{typeof XMLHttpRequest>"u"&&Me(fs,"XMLHttpRequest is undefined");const s=new XMLHttpRequest,t=e.action;s.upload&&s.upload.addEventListener("progress",a=>{const r=a;r.percent=a.total>0?a.loaded/a.total*100:0,e.onProgress(r)});const i=new FormData;if(e.data)for(const[a,r]of Object.entries(e.data))st(r)&&r.length?i.append(a,...r):i.append(a,r);i.append(e.filename,e.file,e.file.name),s.addEventListener("error",()=>{e.onError(De(t,e,s))}),s.addEventListener("load",()=>{if(s.status<200||s.status>=300)return e.onError(De(t,e,s));e.onSuccess(gs(s))}),s.open(e.method,t,!0),e.withCredentials&&"withCredentials"in s&&(s.withCredentials=!0);const o=e.headers||{};if(o instanceof Headers)o.forEach((a,r)=>s.setRequestHeader(r,a));else for(const[a,r]of Object.entries(o))it(r)||s.setRequestHeader(a,String(r));return s.send(i),s},ut=["text","picture","picture-card"];let ws=1;const Se=()=>Date.now()+ws++,pt=de({action:{type:String,default:"#"},headers:{type:Y(Object)},method:{type:String,default:"post"},data:{type:Y([Object,Function,Promise]),default:()=>be({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Y(Array),default:()=>be([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:ut,default:"text"},httpRequest:{type:Y(Function),default:vs},disabled:Boolean,limit:Number}),ys=de({...pt,beforeUpload:{type:Y(Function),default:j},beforeRemove:{type:Y(Function)},onRemove:{type:Y(Function),default:j},onChange:{type:Y(Function),default:j},onPreview:{type:Y(Function),default:j},onSuccess:{type:Y(Function),default:j},onProgress:{type:Y(Function),default:j},onError:{type:Y(Function),default:j},onExceed:{type:Y(Function),default:j},crossorigin:{type:Y(String)}}),bs=de({files:{type:Y(Array),default:()=>be([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Y(Function),default:j},listType:{type:String,values:ut,default:"text"},crossorigin:{type:Y(String)}}),Cs={remove:e=>!!e},_s=["onKeydown"],xs=["src","crossorigin"],Os=["onClick"],ks=["title"],Es=["onClick"],$s=["onClick"],Ss=G({name:"ElUploadList"}),Is=G({...Ss,props:bs,emits:Cs,setup(e,{emit:s}){const t=e,{t:i}=Ge(),o=pe("upload"),a=pe("icon"),r=pe("list"),n=Oe(),m=M(!1),g=te(()=>[o.b("list"),o.bm("list",t.listType),o.is("disabled",t.disabled)]),C=v=>{s("remove",v)};return(v,c)=>(E(),K(Wt,{tag:"ul",class:S(u(g)),name:u(r).b()},{default:d(()=>[(E(!0),W(_e,null,et(v.files,p=>(E(),W("li",{key:p.uid||p.name,class:S([u(o).be("list","item"),u(o).is(p.status),{focusing:m.value}]),tabindex:"0",onKeydown:ot(x=>!u(n)&&C(p),["delete"]),onFocus:c[0]||(c[0]=x=>m.value=!0),onBlur:c[1]||(c[1]=x=>m.value=!1),onClick:c[2]||(c[2]=x=>m.value=!1)},[P(v.$slots,"default",{file:p},()=>[v.listType==="picture"||p.status!=="uploading"&&v.listType==="picture-card"?(E(),W("img",{key:0,class:S(u(o).be("list","item-thumbnail")),src:p.url,crossorigin:v.crossorigin,alt:""},null,10,xs)):I("v-if",!0),p.status==="uploading"||v.listType!=="picture-card"?(E(),W("div",{key:1,class:S(u(o).be("list","item-info"))},[_("a",{class:S(u(o).be("list","item-name")),onClick:ce(x=>v.handlePreview(p),["prevent"])},[l(u(B),{class:S(u(a).m("document"))},{default:d(()=>[l(u(Ht))]),_:1},8,["class"]),_("span",{class:S(u(o).be("list","item-file-name")),title:p.name},xe(p.name),11,ks)],10,Os),p.status==="uploading"?(E(),K(u(Vt),{key:0,type:v.listType==="picture-card"?"circle":"line","stroke-width":v.listType==="picture-card"?6:2,percentage:Number(p.percentage),style:le(v.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):I("v-if",!0)],2)):I("v-if",!0),_("label",{class:S(u(o).be("list","item-status-label"))},[v.listType==="text"?(E(),K(u(B),{key:0,class:S([u(a).m("upload-success"),u(a).m("circle-check")])},{default:d(()=>[l(u(Xt))]),_:1},8,["class"])):["picture-card","picture"].includes(v.listType)?(E(),K(u(B),{key:1,class:S([u(a).m("upload-success"),u(a).m("check")])},{default:d(()=>[l(u(Mt))]),_:1},8,["class"])):I("v-if",!0)],2),u(n)?I("v-if",!0):(E(),K(u(B),{key:2,class:S(u(a).m("close")),onClick:x=>C(p)},{default:d(()=>[l(u(Ze))]),_:2},1032,["class","onClick"])),I(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),I(" This is a bug which needs to be fixed "),I(" TODO: Fix the incorrect navigation interaction "),u(n)?I("v-if",!0):(E(),W("i",{key:3,class:S(u(a).m("close-tip"))},xe(u(i)("el.upload.deleteTip")),3)),v.listType==="picture-card"?(E(),W("span",{key:4,class:S(u(o).be("list","item-actions"))},[_("span",{class:S(u(o).be("list","item-preview")),onClick:x=>v.handlePreview(p)},[l(u(B),{class:S(u(a).m("zoom-in"))},{default:d(()=>[l(u(Je))]),_:1},8,["class"])],10,Es),u(n)?I("v-if",!0):(E(),W("span",{key:0,class:S(u(o).be("list","item-delete")),onClick:x=>C(p)},[l(u(B),{class:S(u(a).m("delete"))},{default:d(()=>[l(u(Yt))]),_:1},8,["class"])],10,$s))],2)):I("v-if",!0)])],42,_s))),128)),P(v.$slots,"append")]),_:3},8,["class","name"]))}});var qe=ge(Is,[["__file","upload-list.vue"]]);const Ls=de({disabled:{type:Boolean,default:!1}}),Hs={file:e=>st(e)},Xs=["onDrop","onDragover"],dt="ElUploadDrag",Ms=G({name:dt}),Ys=G({...Ms,props:Ls,emits:Hs,setup(e,{emit:s}){me(ht)||Me(dt,"usage: <el-upload><el-upload-dragger /></el-upload>");const i=pe("upload"),o=M(!1),a=Oe(),r=m=>{if(a.value)return;o.value=!1,m.stopPropagation();const g=Array.from(m.dataTransfer.files);s("file",g)},n=()=>{a.value||(o.value=!0)};return(m,g)=>(E(),W("div",{class:S([u(i).b("dragger"),u(i).is("dragover",o.value)]),onDrop:ce(r,["prevent"]),onDragover:ce(n,["prevent"]),onDragleave:g[0]||(g[0]=ce(C=>o.value=!1,["prevent"]))},[P(m.$slots,"default")],42,Xs))}});var Ws=ge(Ys,[["__file","upload-dragger.vue"]]);const Ts=de({...pt,beforeUpload:{type:Y(Function),default:j},onRemove:{type:Y(Function),default:j},onStart:{type:Y(Function),default:j},onSuccess:{type:Y(Function),default:j},onProgress:{type:Y(Function),default:j},onError:{type:Y(Function),default:j},onExceed:{type:Y(Function),default:j}}),Rs=["onKeydown"],As=["name","multiple","accept"],Us=G({name:"ElUploadContent",inheritAttrs:!1}),Ns=G({...Us,props:Ts,setup(e,{expose:s}){const t=e,i=pe("upload"),o=Oe(),a=Ce({}),r=Ce(),n=h=>{if(h.length===0)return;const{autoUpload:f,limit:w,fileList:b,multiple:O,onStart:H,onExceed:A}=t;if(w&&b.length+h.length>w){A(h,b);return}O||(h=h.slice(0,1));for(const Q of h){const V=Q;V.uid=Se(),H(V),f&&m(V)}},m=async h=>{if(r.value.value="",!t.beforeUpload)return C(h);let f,w={};try{const O=t.data,H=t.beforeUpload(h);w=Pe(t.data)?Be(t.data):t.data,f=await H,Pe(t.data)&&Qt(O,w)&&(w=Be(t.data))}catch{f=!1}if(f===!1){t.onRemove(h);return}let b=h;f instanceof Blob&&(f instanceof File?b=f:b=new File([f],h.name,{type:h.type})),C(Object.assign(b,{uid:h.uid}),w)},g=async(h,f)=>Rt(h)?h(f):h,C=async(h,f)=>{const{headers:w,data:b,method:O,withCredentials:H,name:A,action:Q,onProgress:V,onSuccess:U,onError:ie,httpRequest:J}=t;try{f=await g(f??b,h)}catch{t.onRemove(h);return}const{uid:z}=h,se={headers:w||{},withCredentials:H,file:h,data:f,method:O,filename:A,action:Q,onProgress:k=>{V(k,h)},onSuccess:k=>{U(k,h),delete a.value[z]},onError:k=>{ie(k,h),delete a.value[z]}},y=J(se);a.value[z]=y,y instanceof Promise&&y.then(se.onSuccess,se.onError)},v=h=>{const f=h.target.files;f&&n(Array.from(f))},c=()=>{o.value||(r.value.value="",r.value.click())},p=()=>{c()};return s({abort:h=>{Tt(a.value).filter(h?([w])=>String(h.uid)===w:()=>!0).forEach(([w,b])=>{b instanceof XMLHttpRequest&&b.abort(),delete a.value[w]})},upload:m}),(h,f)=>(E(),W("div",{class:S([u(i).b(),u(i).m(h.listType),u(i).is("drag",h.drag)]),tabindex:"0",onClick:c,onKeydown:ot(ce(p,["self"]),["enter","space"])},[h.drag?(E(),K(Ws,{key:0,disabled:u(o),onFile:n},{default:d(()=>[P(h.$slots,"default")]),_:3},8,["disabled"])):P(h.$slots,"default",{key:1}),_("input",{ref_key:"inputRef",ref:r,class:S(u(i).e("input")),name:h.name,multiple:h.multiple,accept:h.accept,type:"file",onChange:v,onClick:f[0]||(f[0]=ce(()=>{},["stop"]))},null,42,As)],42,Rs))}});var je=ge(Ns,[["__file","upload-content.vue"]]);const Ve="ElUpload",Ke=e=>{var s;(s=e.url)!=null&&s.startsWith("blob:")&&URL.revokeObjectURL(e.url)},Ps=(e,s)=>{const t=At(e,"fileList",void 0,{passive:!0}),i=c=>t.value.find(p=>p.uid===c.uid);function o(c){var p;(p=s.value)==null||p.abort(c)}function a(c=["ready","uploading","success","fail"]){t.value=t.value.filter(p=>!c.includes(p.status))}const r=(c,p)=>{const x=i(p);x&&(console.error(c),x.status="fail",t.value.splice(t.value.indexOf(x),1),e.onError(c,x,t.value),e.onChange(x,t.value))},n=(c,p)=>{const x=i(p);x&&(e.onProgress(c,x,t.value),x.status="uploading",x.percentage=Math.round(c.percent))},m=(c,p)=>{const x=i(p);x&&(x.status="success",x.response=c,e.onSuccess(c,x,t.value),e.onChange(x,t.value))},g=c=>{it(c.uid)&&(c.uid=Se());const p={name:c.name,percentage:0,status:"ready",size:c.size,raw:c,uid:c.uid};if(e.listType==="picture-card"||e.listType==="picture")try{p.url=URL.createObjectURL(c)}catch(x){Gt(Ve,x.message),e.onError(x,p,t.value)}t.value=[...t.value,p],e.onChange(p,t.value)},C=async c=>{const p=c instanceof File?i(c):c;p||Me(Ve,"file to be removed not found");const x=h=>{o(h);const f=t.value;f.splice(f.indexOf(h),1),e.onRemove(h,f),Ke(h)};e.beforeRemove?await e.beforeRemove(p,t.value)!==!1&&x(p):x(p)};function v(){t.value.filter(({status:c})=>c==="ready").forEach(({raw:c})=>{var p;return c&&((p=s.value)==null?void 0:p.upload(c))})}return fe(()=>e.listType,c=>{c!=="picture-card"&&c!=="picture"||(t.value=t.value.map(p=>{const{raw:x,url:h}=p;if(!h&&x)try{p.url=URL.createObjectURL(x)}catch(f){e.onError(f,p,t.value)}return p}))}),fe(t,c=>{for(const p of c)p.uid||(p.uid=Se()),p.status||(p.status="success")},{immediate:!0,deep:!0}),{uploadFiles:t,abort:o,clearFiles:a,handleError:r,handleProgress:n,handleStart:g,handleSuccess:m,handleRemove:C,submit:v,revokeFileObjectURL:Ke}},zs=G({name:"ElUpload"}),Fs=G({...zs,props:ys,setup(e,{expose:s}){const t=e,i=Oe(),o=Ce(),{abort:a,submit:r,clearFiles:n,uploadFiles:m,handleStart:g,handleError:C,handleRemove:v,handleSuccess:c,handleProgress:p,revokeFileObjectURL:x}=Ps(t,o),h=te(()=>t.listType==="picture-card"),f=te(()=>({...t,fileList:m.value,onStart:g,onProgress:p,onSuccess:c,onError:C,onRemove:v}));return Ut(()=>{m.value.forEach(x)}),Nt(ht,{accept:Pt(t,"accept")}),s({abort:a,submit:r,clearFiles:n,handleStart:g,handleRemove:v}),(w,b)=>(E(),W("div",null,[u(h)&&w.showFileList?(E(),K(qe,{key:0,disabled:u(i),"list-type":w.listType,files:u(m),crossorigin:w.crossorigin,"handle-preview":w.onPreview,onRemove:u(v)},ze({append:d(()=>[l(je,Fe({ref_key:"uploadRef",ref:o},u(f)),{default:d(()=>[w.$slots.trigger?P(w.$slots,"trigger",{key:0}):I("v-if",!0),!w.$slots.trigger&&w.$slots.default?P(w.$slots,"default",{key:1}):I("v-if",!0)]),_:3},16)]),_:2},[w.$slots.file?{name:"default",fn:d(({file:O})=>[P(w.$slots,"file",{file:O})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):I("v-if",!0),!u(h)||u(h)&&!w.showFileList?(E(),K(je,Fe({key:1,ref_key:"uploadRef",ref:o},u(f)),{default:d(()=>[w.$slots.trigger?P(w.$slots,"trigger",{key:0}):I("v-if",!0),!w.$slots.trigger&&w.$slots.default?P(w.$slots,"default",{key:1}):I("v-if",!0)]),_:3},16)):I("v-if",!0),w.$slots.trigger?P(w.$slots,"default",{key:2}):I("v-if",!0),P(w.$slots,"tip"),!u(h)&&w.showFileList?(E(),K(qe,{key:3,disabled:u(i),"list-type":w.listType,files:u(m),crossorigin:w.crossorigin,"handle-preview":w.onPreview,onRemove:u(v)},ze({_:2},[w.$slots.file?{name:"default",fn:d(({file:O})=>[P(w.$slots,"file",{file:O})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):I("v-if",!0)]))}});var Bs=ge(Fs,[["__file","upload.vue"]]);const ft=tt(Bs);function Ie(e){return new Promise((s,t)=>{let i="image/png";const o=new Image;typeof e.fileObj=="object"?(o.src=window.URL.createObjectURL(e.fileObj),e.fileObj.type&&(i=e.fileObj.type)):o.src=e.fileObj,o.onload=function(){let a=e.width?e.width:o.width,r=e.height?e.height:o.height;const n=document.createElement("canvas"),m=n.getContext("2d"),g=document.createAttribute("width");g.nodeValue=a.toString();const C=document.createAttribute("height");C.nodeValue=r.toString(),n.setAttributeNode(g),n.setAttributeNode(C),m==null||m.drawImage(o,0,0,a,r);const v=n.toDataURL(i,e.quality),c=Ds(v,e.fileObj.name);s(c)},o.onerror=function(){t(!1)}})}function Ds(e,s=Date.now().toString()){var n;let t=e.split(","),i=(n=t[0].match(/:(.*?);/))==null?void 0:n[1],o=atob(t[1]),a=o.length,r=new Uint8Array(a);for(;a--;)r[a]=o.charCodeAt(a);return new File([r],s,{type:i})}const Ye=e=>(Le("data-v-a0dabc88"),e=e(),He(),e),qs={class:"fc-upload-box"},js={class:"upload-empty"},Vs=["src"],Ks=["onClick"],Gs=Ye(()=>_("span",null,"查看",-1)),Qs=["onClick"],Zs=Ye(()=>_("span",null,"删除",-1)),Js={key:1,class:"fc-handle-icon move"},ei=Ye(()=>_("span",null,"移动",-1)),ti={class:"el-upload__tip"},si=G({__name:"index",props:{fileList:{default:()=>[]},requestApi:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"},comporess:{type:Boolean,default:!1},comporessQuality:{},sortable:{type:Boolean,default:!1}},emits:["update:fileList"],setup(e,{emit:s}){at(b=>({"41d67f01":b.borderRadius,"6a7ac7fa":b.width,"73c1ea8a":b.height}));const t=e,i=me(rt,void 0),o=me(nt,void 0),a=te(()=>t.disabled||(i==null?void 0:i.disabled)),r=M(t.fileList);Qe(()=>{t.sortable&&n()});const n=()=>{const b=document.querySelector(".el-upload-list");Kt.create(b,{handle:".move",animation:300,onEnd({newIndex:O,oldIndex:H}){const[A]=t.fileList.splice(H,1);t.fileList.splice(O,0,A)}})};fe(()=>t.fileList,b=>{r.value=b});const m=b=>{const O=b.size/1024/1024<t.fileSize,H=t.fileType.includes(b.type);return H||ne({message:"上传图片不符合所需的格式！",type:"warning"}),O||setTimeout(()=>{ne({message:`上传图片大小不能超过 ${t.fileSize}M！`,type:"warning"})},0),H&&O},g=async b=>{let O=new FormData;if(t.comporess)try{let H=await Ie({quality:t.comporessQuality,fileObj:b.file});O.append("file",H)}catch(H){b.onError(H);return}else O.append("file",b.file);try{const H=t.requestApi,{data:A}=await H(O);b.onSuccess(A)}catch(H){b.onError(H)}},C=s,v=(b,O)=>{b&&(O.url=b,C("update:fileList",r.value),o!=null&&o.prop&&(i==null||i.validateField([o.prop])),ne({message:"图片上传成功！",type:"success"}))},c=b=>{r.value=r.value.filter(O=>O.url!==b.url||O.name!==b.name),C("update:fileList",r.value)},p=()=>{ne({message:"图片上传失败，请您重新上传！",type:"error"})},x=()=>{ne({message:`当前最多只能上传 ${t.limit} 张图片，请移除后上传！`,type:"warning"})},h=M(""),f=M(!1),w=b=>{h.value=b.url,f.value=!0};return(b,O)=>{const H=oe("Plus"),A=B,Q=oe("ZoomIn"),V=oe("Delete"),U=oe("Rank"),ie=ft,J=ct;return E(),W("div",qs,[l(ie,{"file-list":r.value,"onUpdate:fileList":O[1]||(O[1]=z=>r.value=z),action:"#","list-type":"picture-card",class:S(["upload",a.value?"disabled":"",b.drag?"no-border":""]),multiple:!0,disabled:a.value,limit:b.limit,"http-request":g,"before-upload":m,"on-exceed":x,"on-success":v,"on-error":p,drag:b.drag,accept:b.fileType.join(",")},{file:d(({file:z})=>[_("img",{src:z.url,class:"fc-upload-image"},null,8,Vs),_("div",{class:"fc-upload-handle",onClick:O[0]||(O[0]=ce(()=>{},["stop"]))},[_("div",{class:"fc-handle-icon",onClick:se=>w(z)},[l(A,null,{default:d(()=>[l(Q)]),_:1}),Gs],8,Ks),a.value?I("",!0):(E(),W("div",{key:0,class:"fc-handle-icon",onClick:se=>c(z)},[l(A,null,{default:d(()=>[l(V)]),_:1}),Zs],8,Qs)),b.sortable?(E(),W("div",Js,[l(A,null,{default:d(()=>[l(U)]),_:1}),ei])):I("",!0)])]),default:d(()=>[_("div",js,[P(b.$slots,"empty",{},()=>[l(A,null,{default:d(()=>[l(H)]),_:1})],!0)])]),_:3},8,["file-list","class","disabled","limit","drag","accept"]),_("div",ti,[P(b.$slots,"tip",{},void 0,!0)]),f.value?(E(),K(J,{key:0,"url-list":[h.value],onClose:O[2]||(O[2]=z=>f.value=!1)},null,8,["url-list"])):I("",!0)])}}}),ii=Xe(si,[["__scopeId","data-v-a0dabc88"]]),mt={};mt.getData=e=>new Promise((s,t)=>{let i={};oi(e).then(o=>{i.arrayBuffer=o;try{i.orientation=li(o)}catch{i.orientation=-1}s(i)}).catch(o=>{t(o)})});function oi(e){let s=null;return new Promise((t,i)=>{if(e.src)if(/^data\:/i.test(e.src))s=ri(e.src),t(s);else if(/^blob\:/i.test(e.src)){var o=new FileReader;o.onload=function(r){s=r.target.result,t(s)},ai(e.src,function(r){o.readAsArrayBuffer(r)})}else{var a=new XMLHttpRequest;a.onload=function(){if(this.status==200||this.status===0)s=a.response,t(s);else throw"Could not load image";a=null},a.open("GET",e.src,!0),a.responseType="arraybuffer",a.send(null)}else i("img error")})}function ai(e,s){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(i){(this.status==200||this.status===0)&&s(this.response)},t.send()}function ri(e,s){s=s||e.match(/^data\:([^\;]+)\;base64,/mi)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gmi,"");for(var t=atob(e),i=t.length%2==0?t.length:t.length+1,o=new ArrayBuffer(i),a=new Uint16Array(o),r=0;r<i;r++)a[r]=t.charCodeAt(r);return o}function ni(e,s,t){var i="",o;for(o=s,t+=s;o<t;o++)i+=String.fromCharCode(e.getUint8(o));return i}function li(e){var s=new DataView(e),t=s.byteLength,i,o,a,r,n,m,g,C,v,c;if(s.getUint8(0)===255&&s.getUint8(1)===216)for(v=2;v<t;){if(s.getUint8(v)===255&&s.getUint8(v+1)===225){g=v;break}v++}if(g&&(o=g+4,a=g+10,ni(s,o,4)==="Exif"&&(m=s.getUint16(a),n=m===18761,(n||m===19789)&&s.getUint16(a+2,n)===42&&(r=s.getUint32(a+4,n),r>=8&&(C=a+r)))),C){for(t=s.getUint16(C,n),c=0;c<t;c++)if(v=C+c*12+2,s.getUint16(v,n)===274){v+=8,i=s.getUint16(v,n);break}}return i}const ci=(e,s)=>{const t=e.__vccOpts||e;for(const[i,o]of s)t[i]=o;return t},hi=G({data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0,imgIsQqualCrop:!1}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:()=>[1,1]},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:[Number,String],default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"},limitMinSize:{type:[Number,Array,String],default:()=>10,validator:function(e){return Array.isArray(e)?Number(e[0])>=0&&Number(e[1])>=0:Number(e)>=0}},fillColor:{type:String,default:""}},computed:{cropInfo(){let e={};if(e.top=this.cropOffsertY>21?"-21px":"0px",e.width=this.cropW>0?this.cropW:0,e.height=this.cropH>0?this.cropH:0,this.infoTrue){let s=1;this.high&&!this.full&&(s=window.devicePixelRatio),this.enlarge!==1&!this.full&&(s=Math.abs(Number(this.enlarge))),e.width=e.width*s,e.height=e.height*s,this.full&&(e.width=e.width/this.scale,e.height=e.height/this.scale)}return e.width=e.width.toFixed(0),e.height=e.height.toFixed(0),e},isIE(){return!!window.ActiveXObject||"ActiveXObject"in window},passive(){return this.isIE?null:{passive:!1}},isRotateRightOrLeft(){return[1,-1,3,-3].includes(this.rotate)}},watch:{img(){this.checkedImg()},imgs(e){e!==""&&this.reload()},cropW(){this.showPreview()},cropH(){this.showPreview()},cropOffsertX(){this.showPreview()},cropOffsertY(){this.showPreview()},scale(e,s){this.showPreview()},x(){this.showPreview()},y(){this.showPreview()},autoCrop(e){e&&this.goAutoCrop()},autoCropWidth(){this.autoCrop&&this.goAutoCrop()},autoCropHeight(){this.autoCrop&&this.goAutoCrop()},mode(){this.checkedImg()},rotate(){this.showPreview(),this.autoCrop?this.goAutoCrop(this.cropW,this.cropH):(this.cropW>0||this.cropH>0)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{getVersion(e){var s=navigator.userAgent.split(" "),t="";let i=0;const o=new RegExp(e,"i");for(var a=0;a<s.length;a++)o.test(s[a])&&(t=s[a]);return t?i=t.split("/")[1].split("."):i=["0","0","0"],i},checkOrientationImage(e,s,t,i){if(this.getVersion("chrome")[0]>=81)s=-1;else if(this.getVersion("safari")[0]>=605){const r=this.getVersion("version");r[0]>13&&r[1]>1&&(s=-1)}else{const r=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);if(r){let n=r[1];n=n.split("_"),(n[0]>13||n[0]>=13&&n[1]>=4)&&(s=-1)}}let o=document.createElement("canvas"),a=o.getContext("2d");switch(a.save(),s){case 2:o.width=t,o.height=i,a.translate(t,0),a.scale(-1,1);break;case 3:o.width=t,o.height=i,a.translate(t/2,i/2),a.rotate(180*Math.PI/180),a.translate(-t/2,-i/2);break;case 4:o.width=t,o.height=i,a.translate(0,i),a.scale(1,-1);break;case 5:o.height=t,o.width=i,a.rotate(.5*Math.PI),a.scale(1,-1);break;case 6:o.width=i,o.height=t,a.translate(i/2,t/2),a.rotate(90*Math.PI/180),a.translate(-t/2,-i/2);break;case 7:o.height=t,o.width=i,a.rotate(.5*Math.PI),a.translate(t,-i),a.scale(-1,1);break;case 8:o.height=t,o.width=i,a.translate(i/2,t/2),a.rotate(-90*Math.PI/180),a.translate(-t/2,-i/2);break;default:o.width=t,o.height=i}a.drawImage(e,0,0,t,i),a.restore(),o.toBlob(r=>{let n=URL.createObjectURL(r);URL.revokeObjectURL(this.imgs),this.imgs=n},"image/"+this.outputType,1)},checkedImg(){if(this.img===null||this.img===""){this.imgs="",this.clearCrop();return}this.loading=!0,this.scale=1,this.rotate=0,this.imgIsQqualCrop=!1,this.clearCrop();let e=new Image;if(e.onload=()=>{if(this.img==="")return this.$emit("img-load",new Error("图片不能为空")),!1;let t=e.width,i=e.height;mt.getData(e).then(o=>{this.orientation=o.orientation||1;let a=Number(this.maxImgSize);if(!this.orientation&&t<a&i<a){this.imgs=this.img;return}t>a&&(i=i/t*a,t=a),i>a&&(t=t/i*a,i=a),this.checkOrientationImage(e,this.orientation,t,i)}).catch(o=>{this.$emit("img-load","error"),this.$emit("img-load-error",o)})},e.onerror=t=>{this.$emit("img-load","error"),this.$emit("img-load-error",t)},this.img.substr(0,4)!=="data"&&(e.crossOrigin=""),this.isIE){var s=new XMLHttpRequest;s.onload=function(){var t=URL.createObjectURL(this.response);e.src=t},s.open("GET",this.img,!0),s.responseType="blob",s.send()}else e.src=this.img},startMove(e){if(e.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=("clientX"in e?e.clientX:e.touches[0].clientX)-this.x,this.moveY=("clientY"in e?e.clientY:e.touches[0].clientY)-this.y,e.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),e.touches.length==2&&(this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=e.offsetX?e.offsetX:e.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=e.offsetY?e.offsetY:e.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale(e){e.preventDefault();let s=this.scale;var t={x:this.touches[0].clientX,y:this.touches[0].clientY},i={x:e.touches[0].clientX,y:e.touches[0].clientY},o={x:this.touches[1].clientX,y:this.touches[1].clientY},a={x:e.touches[1].clientX,y:e.touches[1].clientY},r=Math.sqrt(Math.pow(t.x-o.x,2)+Math.pow(t.y-o.y,2)),n=Math.sqrt(Math.pow(i.x-a.x,2)+Math.pow(i.y-a.y,2)),m=n-r,g=1;g=g/this.trueWidth>g/this.trueHeight?g/this.trueHeight:g/this.trueWidth,g=g>.1?.1:g;var C=g*m;if(!this.touchNow){if(this.touchNow=!0,m>0?s+=Math.abs(C):m<0&&s>Math.abs(C)&&(s-=Math.abs(C)),this.touches=e.touches,setTimeout(()=>{this.touchNow=!1},8),!this.checkoutImgAxis(this.x,this.y,s))return!1;this.scale=s}},cancelTouchScale(e){window.removeEventListener("touchmove",this.touchScale)},moveImg(e){if(e.preventDefault(),e.touches&&e.touches.length===2)return this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;let s="clientX"in e?e.clientX:e.touches[0].clientX,t="clientY"in e?e.clientY:e.touches[0].clientY,i,o;i=s-this.moveX,o=t-this.moveY,this.$nextTick(()=>{if(this.centerBox){let a=this.getImgAxis(i,o,this.scale),r=this.getCropAxis(),n=this.trueHeight*this.scale,m=this.trueWidth*this.scale,g,C,v,c;switch(this.rotate){case 1:case-1:case 3:case-3:g=this.cropOffsertX-this.trueWidth*(1-this.scale)/2+(n-m)/2,C=this.cropOffsertY-this.trueHeight*(1-this.scale)/2+(m-n)/2,v=g-n+this.cropW,c=C-m+this.cropH;break;default:g=this.cropOffsertX-this.trueWidth*(1-this.scale)/2,C=this.cropOffsertY-this.trueHeight*(1-this.scale)/2,v=g-m+this.cropW,c=C-n+this.cropH;break}a.x1>=r.x1&&(i=g),a.y1>=r.y1&&(o=C),a.x2<=r.x2&&(i=v),a.y2<=r.y2&&(o=c)}this.x=i,this.y=o,this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})})},leaveImg(e){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("img-moving",{moving:!1,axis:this.getImgAxis()})},scaleImg(){this.canScale&&window.addEventListener(this.support,this.changeSize,this.passive)},cancelScale(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize(e){e.preventDefault();let s=this.scale;var t=e.deltaY||e.wheelDelta,i=navigator.userAgent.indexOf("Firefox");t=i>0?t*30:t,this.isIE&&(t=-t);var o=this.coe;o=o/this.trueWidth>o/this.trueHeight?o/this.trueHeight:o/this.trueWidth;var a=o*t;a<0?s+=Math.abs(a):s>Math.abs(a)&&(s-=Math.abs(a));let r=a<0?"add":"reduce";if(r!==this.coeStatus&&(this.coeStatus=r,this.coe=.2),this.scaling||(this.scalingSet=setTimeout(()=>{this.scaling=!1,this.coe=this.coe+=.01},50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,s))return!1;this.scale=s},changeScale(e){let s=this.scale;e=e||1;var t=20;if(t=t/this.trueWidth>t/this.trueHeight?t/this.trueHeight:t/this.trueWidth,e=e*t,e>0?s+=Math.abs(e):s>Math.abs(e)&&(s-=Math.abs(e)),!this.checkoutImgAxis(this.x,this.y,s))return!1;this.scale=s},createCrop(e){e.preventDefault();var s="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,t="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;this.$nextTick(()=>{var i=s-this.cropX,o=t-this.cropY;if(i>0?(this.cropW=i+this.cropChangeX>this.w?this.w-this.cropChangeX:i,this.cropOffsertX=this.cropChangeX):(this.cropW=this.w-this.cropChangeX+Math.abs(i)>this.w?this.cropChangeX:Math.abs(i),this.cropOffsertX=this.cropChangeX+i>0?this.cropChangeX+i:0),!this.fixed)o>0?(this.cropH=o+this.cropChangeY>this.h?this.h-this.cropChangeY:o,this.cropOffsertY=this.cropChangeY):(this.cropH=this.h-this.cropChangeY+Math.abs(o)>this.h?this.cropChangeY:Math.abs(o),this.cropOffsertY=this.cropChangeY+o>0?this.cropChangeY+o:0);else{var a=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];a+this.cropOffsertY>this.h?(this.cropH=this.h-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],i>0?this.cropOffsertX=this.cropChangeX:this.cropOffsertX=this.cropChangeX-this.cropW):this.cropH=a,this.cropOffsertY=this.cropOffsertY}})},changeCropSize(e,s,t,i,o){e.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=s,this.canChangeY=t,this.changeCropTypeX=i,this.changeCropTypeY=o,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0),this.$emit("change-crop-size",{width:this.cropW,height:this.cropH})},changeCropNow(e){e.preventDefault();var s="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,t="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;let i=this.w,o=this.h,a=0,r=0;if(this.centerBox){let g=this.getImgAxis(),C=g.x2,v=g.y2;a=g.x1>0?g.x1:0,r=g.y1>0?g.y1:0,i>C&&(i=C),o>v&&(o=v)}const[n,m]=this.checkCropLimitSize();this.$nextTick(()=>{var g=s-this.cropX,C=t-this.cropY;if(this.canChangeX&&(this.changeCropTypeX===1?this.cropOldW-g<n?(this.cropW=n,this.cropOffsertX=this.cropOldW+this.cropChangeX-a-n):this.cropOldW-g>0?(this.cropW=i-this.cropChangeX-g<=i-a?this.cropOldW-g:this.cropOldW+this.cropChangeX-a,this.cropOffsertX=i-this.cropChangeX-g<=i-a?this.cropChangeX+g:a):(this.cropW=Math.abs(g)+this.cropChangeX<=i?Math.abs(g)-this.cropOldW:i-this.cropOldW-this.cropChangeX,this.cropOffsertX=this.cropChangeX+this.cropOldW):this.changeCropTypeX===2&&(this.cropOldW+g<n?this.cropW=n:this.cropOldW+g>0?(this.cropW=this.cropOldW+g+this.cropOffsertX<=i?this.cropOldW+g:i-this.cropOffsertX,this.cropOffsertX=this.cropChangeX):(this.cropW=i-this.cropChangeX+Math.abs(g+this.cropOldW)<=i-a?Math.abs(g+this.cropOldW):this.cropChangeX-a,this.cropOffsertX=i-this.cropChangeX+Math.abs(g+this.cropOldW)<=i-a?this.cropChangeX-Math.abs(g+this.cropOldW):a))),this.canChangeY&&(this.changeCropTypeY===1?this.cropOldH-C<m?(this.cropH=m,this.cropOffsertY=this.cropOldH+this.cropChangeY-r-m):this.cropOldH-C>0?(this.cropH=o-this.cropChangeY-C<=o-r?this.cropOldH-C:this.cropOldH+this.cropChangeY-r,this.cropOffsertY=o-this.cropChangeY-C<=o-r?this.cropChangeY+C:r):(this.cropH=Math.abs(C)+this.cropChangeY<=o?Math.abs(C)-this.cropOldH:o-this.cropOldH-this.cropChangeY,this.cropOffsertY=this.cropChangeY+this.cropOldH):this.changeCropTypeY===2&&(this.cropOldH+C<m?this.cropH=m:this.cropOldH+C>0?(this.cropH=this.cropOldH+C+this.cropOffsertY<=o?this.cropOldH+C:o-this.cropOffsertY,this.cropOffsertY=this.cropChangeY):(this.cropH=o-this.cropChangeY+Math.abs(C+this.cropOldH)<=o-r?Math.abs(C+this.cropOldH):this.cropChangeY-r,this.cropOffsertY=o-this.cropChangeY+Math.abs(C+this.cropOldH)<=o-r?this.cropChangeY-Math.abs(C+this.cropOldH):r))),this.canChangeX&&this.fixed){var v=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];v<m?(this.cropH=m,this.cropW=this.fixedNumber[0]*m/this.fixedNumber[1],this.changeCropTypeX===1&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):v+this.cropOffsertY>o?(this.cropH=o-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],this.changeCropTypeX===1&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):this.cropH=v}if(this.canChangeY&&this.fixed){var c=this.cropH/this.fixedNumber[1]*this.fixedNumber[0];c<n?(this.cropW=n,this.cropH=this.fixedNumber[1]*n/this.fixedNumber[0],this.cropOffsertY=this.cropOldH+this.cropChangeY-this.cropH):c+this.cropOffsertX>i?(this.cropW=i-this.cropOffsertX,this.cropH=this.cropW/this.fixedNumber[0]*this.fixedNumber[1]):this.cropW=c}})},checkCropLimitSize(){let{cropW:e,cropH:s,limitMinSize:t}=this,i=new Array;return Array.isArray(t)?i=t:i=[t,t],e=parseFloat(i[0]),s=parseFloat(i[1]),[e,s]},changeCropEnd(e){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},calculateSize(e,s,t,i,o,a){const r=e/s;let n=o,m=a;return n<t&&(n=t,m=Math.ceil(n/r)),m<i&&(m=i,n=Math.ceil(m*r),n<t&&(n=t,m=Math.ceil(n/r))),n<o&&(n=o,m=Math.ceil(n/r)),m<a&&(m=a,n=Math.ceil(m*r)),{width:n,height:m}},endCrop(){this.cropW===0&&this.cropH===0&&(this.cropping=!1);let[e,s]=this.checkCropLimitSize();const{width:t,height:i}=this.fixed?this.calculateSize(this.fixedNumber[0],this.fixedNumber[1],e,s,this.cropW,this.cropH):{width:e,height:s};t>this.cropW&&(this.cropW=t,this.cropOffsertX+t>this.w&&(this.cropOffsertX=this.w-t)),i>this.cropH&&(this.cropH=i,this.cropOffsertY+i>this.h&&(this.cropOffsertY=this.h-i)),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop(){this.crop=!0},stopCrop(){this.crop=!1},clearCrop(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove(e){if(e.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(e),!1;if(e.touches&&e.touches.length===2)return this.crop=!1,this.startMove(e),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);let s="clientX"in e?e.clientX:e.touches[0].clientX,t="clientY"in e?e.clientY:e.touches[0].clientY,i,o;i=s-this.cropOffsertX,o=t-this.cropOffsertY,this.cropX=i,this.cropY=o,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})},moveCrop(e,s){let t=0,i=0;e&&(e.preventDefault(),t="clientX"in e?e.clientX:e.touches[0].clientX,i="clientY"in e?e.clientY:e.touches[0].clientY),this.$nextTick(()=>{let o,a,r=t-this.cropX,n=i-this.cropY;if(s&&(r=this.cropOffsertX,n=this.cropOffsertY),r<=0?o=0:r+this.cropW>this.w?o=this.w-this.cropW:o=r,n<=0?a=0:n+this.cropH>this.h?a=this.h-this.cropH:a=n,this.centerBox){let m=this.getImgAxis();o<=m.x1&&(o=m.x1),o+this.cropW>m.x2&&(o=m.x2-this.cropW),a<=m.y1&&(a=m.y1),a+this.cropH>m.y2&&(a=m.y2-this.cropH)}this.cropOffsertX=o,this.cropOffsertY=a,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})})},getImgAxis(e,s,t){e=e||this.x,s=s||this.y,t=t||this.scale;let i={x1:0,x2:0,y1:0,y2:0},o=this.trueWidth*t,a=this.trueHeight*t;switch(this.rotate){case 0:i.x1=e+this.trueWidth*(1-t)/2,i.x2=i.x1+this.trueWidth*t,i.y1=s+this.trueHeight*(1-t)/2,i.y2=i.y1+this.trueHeight*t;break;case 1:case-1:case 3:case-3:i.x1=e+this.trueWidth*(1-t)/2+(o-a)/2,i.x2=i.x1+this.trueHeight*t,i.y1=s+this.trueHeight*(1-t)/2+(a-o)/2,i.y2=i.y1+this.trueWidth*t;break;default:i.x1=e+this.trueWidth*(1-t)/2,i.x2=i.x1+this.trueWidth*t,i.y1=s+this.trueHeight*(1-t)/2,i.y2=i.y1+this.trueHeight*t;break}return i},getCropAxis(){let e={x1:0,x2:0,y1:0,y2:0};return e.x1=this.cropOffsertX,e.x2=e.x1+this.cropW,e.y1=this.cropOffsertY,e.y2=e.y1+this.cropH,e},leaveCrop(e){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("crop-moving",{moving:!1,axis:this.getCropAxis()})},getCropChecked(e){let s=document.createElement("canvas"),t=s.getContext("2d"),i=new Image,o=this.rotate,a=this.trueWidth,r=this.trueHeight,n=this.cropOffsertX,m=this.cropOffsertY;i.onload=()=>{if(this.cropW!==0){let c=1;this.high&!this.full&&(c=window.devicePixelRatio),this.enlarge!==1&!this.full&&(c=Math.abs(Number(this.enlarge)));let p=this.cropW*c,x=this.cropH*c,h=a*this.scale*c,f=r*this.scale*c,w=(this.x-n+this.trueWidth*(1-this.scale)/2)*c,b=(this.y-m+this.trueHeight*(1-this.scale)/2)*c;switch(v(p,x),t.save(),o){case 0:this.full?(v(p/this.scale,x/this.scale),t.drawImage(i,w/this.scale,b/this.scale,h/this.scale,f/this.scale)):t.drawImage(i,w,b,h,f);break;case 1:case-3:this.full?(v(p/this.scale,x/this.scale),w=w/this.scale+(h/this.scale-f/this.scale)/2,b=b/this.scale+(f/this.scale-h/this.scale)/2,t.rotate(o*90*Math.PI/180),t.drawImage(i,b,-w-f/this.scale,h/this.scale,f/this.scale)):(w=w+(h-f)/2,b=b+(f-h)/2,t.rotate(o*90*Math.PI/180),t.drawImage(i,b,-w-f,h,f));break;case 2:case-2:this.full?(v(p/this.scale,x/this.scale),t.rotate(o*90*Math.PI/180),w=w/this.scale,b=b/this.scale,t.drawImage(i,-w-h/this.scale,-b-f/this.scale,h/this.scale,f/this.scale)):(t.rotate(o*90*Math.PI/180),t.drawImage(i,-w-h,-b-f,h,f));break;case 3:case-1:this.full?(v(p/this.scale,x/this.scale),w=w/this.scale+(h/this.scale-f/this.scale)/2,b=b/this.scale+(f/this.scale-h/this.scale)/2,t.rotate(o*90*Math.PI/180),t.drawImage(i,-b-h/this.scale,w,h/this.scale,f/this.scale)):(w=w+(h-f)/2,b=b+(f-h)/2,t.rotate(o*90*Math.PI/180),t.drawImage(i,-b-h,w,h,f));break;default:this.full?(v(p/this.scale,x/this.scale),t.drawImage(i,w/this.scale,b/this.scale,h/this.scale,f/this.scale)):t.drawImage(i,w,b,h,f)}t.restore()}else{let c=a*this.scale,p=r*this.scale;switch(t.save(),this.fillColor&&(t.fillStyle=this.fillColor,t.fillRect(0,0,s.width,s.height)),o){case 0:v(c,p),t.drawImage(i,0,0,c,p);break;case 1:case-3:v(p,c),t.rotate(o*90*Math.PI/180),t.drawImage(i,0,-p,c,p);break;case 2:case-2:v(c,p),t.rotate(o*90*Math.PI/180),t.drawImage(i,-c,-p,c,p);break;case 3:case-1:v(p,c),t.rotate(o*90*Math.PI/180),t.drawImage(i,-c,0,c,p);break;default:v(c,p),t.drawImage(i,0,0,c,p)}t.restore()}e(s)};var g=this.img.substr(0,4);g!=="data"&&(i.crossOrigin="Anonymous"),i.src=this.imgs;const C=this.fillColor;function v(c,p){s.width=Math.round(c),s.height=Math.round(p),C&&(t.fillStyle=C,t.fillRect(0,0,s.width,s.height))}},getCropData(e){this.getCropChecked(s=>{e(s.toDataURL("image/"+this.outputType,this.outputSize))})},getCropBlob(e){this.getCropChecked(s=>{s.toBlob(t=>e(t),"image/"+this.outputType,this.outputSize)})},showPreview(){if(this.isCanShow)this.isCanShow=!1,setTimeout(()=>{this.isCanShow=!0},16);else return!1;let e=this.cropW,s=this.cropH,t=this.scale;var i={};i.div={width:`${e}px`,height:`${s}px`};let o=(this.x-this.cropOffsertX)/t,a=(this.y-this.cropOffsertY)/t,r=0;i.w=e,i.h=s,i.url=this.imgs,i.img={width:`${this.trueWidth}px`,height:`${this.trueHeight}px`,transform:`scale(${t})translate3d(${o}px, ${a}px, ${r}px)rotateZ(${this.rotate*90}deg)`},i.html=`
      <div class="show-preview" style="width: ${i.w}px; height: ${i.h}px,; overflow: hidden">
        <div style="width: ${e}px; height: ${s}px">
          <img src=${i.url} style="width: ${this.trueWidth}px; height: ${this.trueHeight}px; transform:
          scale(${t})translate3d(${o}px, ${a}px, ${r}px)rotateZ(${this.rotate*90}deg)">
        </div>
      </div>`,this.$emit("real-time",i)},reload(){let e=new Image;e.onload=()=>{this.w=parseFloat(window.getComputedStyle(this.$refs.cropper).width),this.h=parseFloat(window.getComputedStyle(this.$refs.cropper).height),this.trueWidth=e.width,this.trueHeight=e.height,this.original?this.scale=1:this.scale=this.checkedMode(),this.$nextTick(()=>{this.x=-(this.trueWidth-this.trueWidth*this.scale)/2+(this.w-this.trueWidth*this.scale)/2,this.y=-(this.trueHeight-this.trueHeight*this.scale)/2+(this.h-this.trueHeight*this.scale)/2,this.loading=!1,this.autoCrop&&this.goAutoCrop(),this.$emit("img-load","success"),setTimeout(()=>{this.showPreview()},20)})},e.onerror=()=>{this.$emit("img-load","error")},e.src=this.imgs},checkedMode(){let e=1,s=this.trueWidth,t=this.trueHeight;const i=this.mode.split(" ");switch(i[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":s=this.w,e=s/this.trueWidth,t=t*e,t<this.h&&(t=this.h,e=t/this.trueHeight);break;default:try{let o=i[0];if(o.search("px")!==-1){o=o.replace("px",""),s=parseFloat(o);const a=s/this.trueWidth;let r=1,n=i[1];n.search("px")!==-1&&(n=n.replace("px",""),t=parseFloat(n),r=t/this.trueHeight),e=Math.min(a,r)}if(o.search("%")!==-1&&(o=o.replace("%",""),s=parseFloat(o)/100*this.w,e=s/this.trueWidth),i.length===2&&o==="auto"){let a=i[1];a.search("px")!==-1&&(a=a.replace("px",""),t=parseFloat(a),e=t/this.trueHeight),a.search("%")!==-1&&(a=a.replace("%",""),t=parseFloat(a)/100*this.h,e=t/this.trueHeight)}}catch{e=1}}return e},goAutoCrop(e,s){if(this.imgs===""||this.imgs===null)return;this.clearCrop(),this.cropping=!0;let t=this.w,i=this.h;if(this.centerBox){const r=Math.abs(this.rotate)%2>0;let n=(r?this.trueHeight:this.trueWidth)*this.scale,m=(r?this.trueWidth:this.trueHeight)*this.scale;t=n<t?n:t,i=m<i?m:i}var o=e||parseFloat(this.autoCropWidth),a=s||parseFloat(this.autoCropHeight);(o===0||a===0)&&(o=t*.8,a=i*.8),o=o>t?t:o,a=a>i?i:a,this.fixed&&(a=o/this.fixedNumber[0]*this.fixedNumber[1]),a>this.h&&(a=this.h,o=a/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(o,a)},changeCrop(e,s){if(this.centerBox){let t=this.getImgAxis();e>t.x2-t.x1&&(e=t.x2-t.x1,s=e/this.fixedNumber[0]*this.fixedNumber[1]),s>t.y2-t.y1&&(s=t.y2-t.y1,e=s/this.fixedNumber[1]*this.fixedNumber[0])}this.cropW=e,this.cropH=s,this.checkCropLimitSize(),this.$nextTick(()=>{this.cropOffsertX=(this.w-this.cropW)/2,this.cropOffsertY=(this.h-this.cropH)/2,this.centerBox&&this.moveCrop(null,!0)})},refresh(){this.img,this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.imgIsQqualCrop=!1,this.clearCrop(),this.$nextTick(()=>{this.checkedImg()})},rotateLeft(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight(){this.rotate=this.rotate>=3?0:this.rotate+1},rotateClear(){this.rotate=0},checkoutImgAxis(e,s,t){e=e||this.x,s=s||this.y,t=t||this.scale;let i=!0;if(this.centerBox){let o=this.getImgAxis(e,s,t),a=this.getCropAxis();o.x1>=a.x1&&(i=!1),o.x2<=a.x2&&(i=!1),o.y1>=a.y1&&(i=!1),o.y2<=a.y2&&(i=!1),i||this.changeImgScale(o,a,t)}return i},changeImgScale(e,s,t){let i=this.trueWidth,o=this.trueHeight,a=i*t,r=o*t;if(a>=this.cropW&&r>=this.cropH)this.scale=t;else{const n=this.cropW/i,m=this.cropH/o,g=this.cropH<=o*n?n:m;this.scale=g,a=i*g,r=o*g}this.imgIsQqualCrop||(e.x1>=s.x1&&(this.isRotateRightOrLeft?this.x=s.x1-(i-a)/2-(a-r)/2:this.x=s.x1-(i-a)/2),e.x2<=s.x2&&(this.isRotateRightOrLeft?this.x=s.x1-(i-a)/2-(a-r)/2-r+this.cropW:this.x=s.x2-(i-a)/2-a),e.y1>=s.y1&&(this.isRotateRightOrLeft?this.y=s.y1-(o-r)/2-(r-a)/2:this.y=s.y1-(o-r)/2),e.y2<=s.y2&&(this.isRotateRightOrLeft?this.y=s.y2-(o-r)/2-(r-a)/2-a:this.y=s.y2-(o-r)/2-r)),(a<this.cropW||r<this.cropH)&&(this.imgIsQqualCrop=!0)}},mounted(){this.support="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";let e=this;var s=navigator.userAgent;this.isIOS=!!s.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,i,o){for(var a=atob(this.toDataURL(i,o).split(",")[1]),r=a.length,n=new Uint8Array(r),m=0;m<r;m++)n[m]=a.charCodeAt(m);t(new Blob([n],{type:e.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},unmounted(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.cancelScale()}}),ui={key:0,class:"cropper-box"},pi=["src"],di={class:"cropper-view-box"},fi=["src"],mi={key:1};function gi(e,s,t,i,o,a){return E(),W("div",{class:"vue-cropper",ref:"cropper",onMouseover:s[28]||(s[28]=(...r)=>e.scaleImg&&e.scaleImg(...r)),onMouseout:s[29]||(s[29]=(...r)=>e.cancelScale&&e.cancelScale(...r))},[e.imgs?(E(),W("div",ui,[Ee(_("div",{class:"cropper-box-canvas",style:le({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"})},[_("img",{src:e.imgs,alt:"cropper-img",ref:"cropperImg"},null,8,pi)],4),[[$e,!e.loading]])])):I("",!0),_("div",{class:S(["cropper-drag-box",{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping}]),onMousedown:s[0]||(s[0]=(...r)=>e.startMove&&e.startMove(...r)),onTouchstart:s[1]||(s[1]=(...r)=>e.startMove&&e.startMove(...r))},null,34),Ee(_("div",{class:"cropper-crop-box",style:le({width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"})},[_("span",di,[_("img",{style:le({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"}),src:e.imgs,alt:"cropper-img"},null,12,fi)]),_("span",{class:"cropper-face cropper-move",onMousedown:s[2]||(s[2]=(...r)=>e.cropMove&&e.cropMove(...r)),onTouchstart:s[3]||(s[3]=(...r)=>e.cropMove&&e.cropMove(...r))},null,32),e.info?(E(),W("span",{key:0,class:"crop-info",style:le({top:e.cropInfo.top})},xe(e.cropInfo.width)+" × "+xe(e.cropInfo.height),5)):I("",!0),e.fixedBox?I("",!0):(E(),W("span",mi,[_("span",{class:"crop-line line-w",onMousedown:s[4]||(s[4]=r=>e.changeCropSize(r,!1,!0,0,1)),onTouchstart:s[5]||(s[5]=r=>e.changeCropSize(r,!1,!0,0,1))},null,32),_("span",{class:"crop-line line-a",onMousedown:s[6]||(s[6]=r=>e.changeCropSize(r,!0,!1,1,0)),onTouchstart:s[7]||(s[7]=r=>e.changeCropSize(r,!0,!1,1,0))},null,32),_("span",{class:"crop-line line-s",onMousedown:s[8]||(s[8]=r=>e.changeCropSize(r,!1,!0,0,2)),onTouchstart:s[9]||(s[9]=r=>e.changeCropSize(r,!1,!0,0,2))},null,32),_("span",{class:"crop-line line-d",onMousedown:s[10]||(s[10]=r=>e.changeCropSize(r,!0,!1,2,0)),onTouchstart:s[11]||(s[11]=r=>e.changeCropSize(r,!0,!1,2,0))},null,32),_("span",{class:"crop-point point1",onMousedown:s[12]||(s[12]=r=>e.changeCropSize(r,!0,!0,1,1)),onTouchstart:s[13]||(s[13]=r=>e.changeCropSize(r,!0,!0,1,1))},null,32),_("span",{class:"crop-point point2",onMousedown:s[14]||(s[14]=r=>e.changeCropSize(r,!1,!0,0,1)),onTouchstart:s[15]||(s[15]=r=>e.changeCropSize(r,!1,!0,0,1))},null,32),_("span",{class:"crop-point point3",onMousedown:s[16]||(s[16]=r=>e.changeCropSize(r,!0,!0,2,1)),onTouchstart:s[17]||(s[17]=r=>e.changeCropSize(r,!0,!0,2,1))},null,32),_("span",{class:"crop-point point4",onMousedown:s[18]||(s[18]=r=>e.changeCropSize(r,!0,!1,1,0)),onTouchstart:s[19]||(s[19]=r=>e.changeCropSize(r,!0,!1,1,0))},null,32),_("span",{class:"crop-point point5",onMousedown:s[20]||(s[20]=r=>e.changeCropSize(r,!0,!1,2,0)),onTouchstart:s[21]||(s[21]=r=>e.changeCropSize(r,!0,!1,2,0))},null,32),_("span",{class:"crop-point point6",onMousedown:s[22]||(s[22]=r=>e.changeCropSize(r,!0,!0,1,2)),onTouchstart:s[23]||(s[23]=r=>e.changeCropSize(r,!0,!0,1,2))},null,32),_("span",{class:"crop-point point7",onMousedown:s[24]||(s[24]=r=>e.changeCropSize(r,!1,!0,0,2)),onTouchstart:s[25]||(s[25]=r=>e.changeCropSize(r,!1,!0,0,2))},null,32),_("span",{class:"crop-point point8",onMousedown:s[26]||(s[26]=r=>e.changeCropSize(r,!0,!0,2,2)),onTouchstart:s[27]||(s[27]=r=>e.changeCropSize(r,!0,!0,2,2))},null,32)]))],4),[[$e,e.cropping]])],544)}const vi=ci(hi,[["render",gi],["__scopeId","data-v-c21c565e"]]),We=e=>(Le("data-v-45f31c70"),e=e(),He(),e),wi={class:"fc-upload-box"},yi=["src"],bi=We(()=>_("span",null,"编辑",-1)),Ci=We(()=>_("span",null,"查看",-1)),_i=We(()=>_("span",null,"删除",-1)),xi={key:1,class:"fc-upload-empty"},Oi={class:"el-upload__tip"},ki=["src"],Ei=G({__name:"index",props:{imageUrl:{default:""},requestApi:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"},cropper:{type:Boolean,default:!1},cropperOption:{default:()=>({autoCropWidth:200,autoCropHeight:200,outputType:"png",autoCrop:!0,fixedBox:!1})},comporess:{type:Boolean,default:!1},comporessQuality:{}},emits:["update:imageUrl"],setup(e,{emit:s}){at(y=>({b5b8f692:y.width,"3503cf54":y.height,"167423cd":y.borderRadius}));const t=e,i=M("id-"+is()),o=M(!1),a=me(rt,void 0),r=me(nt,void 0),n=te(()=>t.disabled||(a==null?void 0:a.disabled)),m=M(!1),g=M(),C=M(""),v=M({}),c=y=>{if(!t.cropper)return;m.value=!0;let k=new FileReader;k.readAsDataURL(y.raw),k.onload=T=>{var Z;C.value=(Z=T.target)==null?void 0:Z.result}},p=y=>{const k=y.size/1024/1024<t.fileSize,T=t.fileType.includes(y.type);return T||ne({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),k||setTimeout(()=>{ne({title:"温馨提示",message:`上传图片大小不能超过 ${t.fileSize}M！`,type:"warning"})},0),T&&k},x=s,h=async y=>{let k=new FormData;if(t.comporess)try{let T=await Ie({quality:t.comporessQuality,fileObj:y.file});k.append("file",T)}catch(T){y.onError(T);return}else k.append("file",y.file);w(k,T=>{y.onError(T)})},f=()=>{g.value.getCropBlob(async y=>{let k=new FormData;if(t.comporess)try{let T=await Ie({quality:t.comporessQuality,fileObj:y});k.append("file",T)}catch{return}else k.append("file",y);w(k)})},w=async(y,k)=>{try{const T=t.requestApi,{data:Z}=await T(y);x("update:imageUrl",Z),m.value=!1,r!=null&&r.prop&&(a==null||a.validateField([r.prop]))}catch(T){k?k(T):A()}},b=()=>{x("update:imageUrl","")},O=()=>{const y=document.querySelector(`#${i.value} .el-upload__input`);y&&y.dispatchEvent(new MouseEvent("click"))},H=()=>{ne({message:"图片上传成功！",type:"success"})},A=()=>{ne({message:"图片上传失败，请您重新上传！",type:"error"})},Q=()=>{},V=()=>{},U=y=>{y=y||1,g.value.changeScale(y)},ie=()=>{g.value.rotateLeft()},J=()=>{g.value.rotateRight()},z=y=>{v.value=y},se=()=>{m.value=!1};return(y,k)=>{const T=oe("Edit"),Z=B,ve=oe("ZoomIn"),we=oe("Delete"),ae=oe("Plus"),$=ft,X=ct,L=ss,D=ts,F=lt,q=es;return E(),W("div",wi,[l($,{id:i.value,action:"#",class:S(["upload",n.value?"disabled":"",y.drag?"no-border":""]),multiple:!1,disabled:n.value,"show-file-list":!1,"on-change":c,"http-request":h,"before-upload":p,"on-success":H,"on-error":A,drag:y.drag,accept:y.fileType.join(","),"auto-upload":!y.cropper},{default:d(()=>[y.imageUrl?(E(),W(_e,{key:0},[_("img",{src:y.imageUrl,class:"fc-upload-image"},null,8,yi),_("div",{class:"fc-upload-handle",onClick:k[1]||(k[1]=ce(()=>{},["stop"]))},[n.value?I("",!0):(E(),W("div",{key:0,class:"fc-handle-icon",onClick:O},[l(Z,null,{default:d(()=>[l(T)]),_:1}),bi])),_("div",{class:"fc-handle-icon",onClick:k[0]||(k[0]=R=>o.value=!0)},[l(Z,null,{default:d(()=>[l(ve)]),_:1}),Ci]),n.value?I("",!0):(E(),W("div",{key:1,class:"fc-handle-icon",onClick:b},[l(Z,null,{default:d(()=>[l(we)]),_:1}),_i]))])],64)):(E(),W("div",xi,[P(y.$slots,"empty",{},()=>[l(Z,null,{default:d(()=>[l(ae)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept","auto-upload"]),_("div",Oi,[P(y.$slots,"tip",{},void 0,!0)]),o.value?(E(),K(X,{key:0,"url-list":[y.imageUrl],onClose:k[2]||(k[2]=R=>o.value=!1)},null,8,["url-list"])):I("",!0),l(q,{title:"图片裁剪",modelValue:m.value,"onUpdate:modelValue":k[7]||(k[7]=R=>m.value=R),width:"800px","append-to-body":"",onOpened:Q,onClose:V},{default:d(()=>[l(D,null,{default:d(()=>[l(L,{xs:24,md:12,span:12,style:{height:"300px"}},{default:d(()=>{var R,re,Te,Re,Ae;return[l(u(vi),{ref_key:"cropperRef",ref:g,img:C.value,info:!0,autoCrop:(R=y.cropperOption)==null?void 0:R.autoCrop,autoCropWidth:(re=y.cropperOption)==null?void 0:re.autoCropWidth,autoCropHeight:(Te=y.cropperOption)==null?void 0:Te.autoCropHeight,fixedBox:(Re=y.cropperOption)==null?void 0:Re.fixedBox,outputType:(Ae=y.cropperOption)==null?void 0:Ae.outputType,onRealTime:z},null,8,["img","autoCrop","autoCropWidth","autoCropHeight","fixedBox","outputType"])]}),_:1}),l(L,{span:12,xs:24,md:12,style:{height:"300px"}},{default:d(()=>[_("div",{class:"fc-preview-box",style:le(`width:${v.value.w}px;height:${v.value.h}px;border-radius:${y.borderRadius}`)},[_("img",{src:v.value.url,style:le(v.value.img)},null,12,ki)],4)]),_:1})]),_:1}),l(D,{style:{"margin-top":"12px"}},{default:d(()=>[l(L,{span:12},{default:d(()=>[l(D,null,{default:d(()=>[l(L,{span:4},{default:d(()=>[l(F,{icon:"Plus",onClick:k[3]||(k[3]=R=>U(1))})]),_:1}),l(L,{span:4},{default:d(()=>[l(F,{icon:"Minus",onClick:k[4]||(k[4]=R=>U(-1))})]),_:1}),l(L,{span:4},{default:d(()=>[l(F,{icon:"RefreshLeft",onClick:k[5]||(k[5]=R=>ie())})]),_:1}),l(L,{span:4},{default:d(()=>[l(F,{icon:"RefreshRight",onClick:k[6]||(k[6]=R=>J())})]),_:1})]),_:1})]),_:1}),l(L,{span:12},{default:d(()=>[l(D,null,{default:d(()=>[l(L,{span:4,offset:14},{default:d(()=>[l(F,{type:"primary",plain:"",onClick:se},{default:d(()=>[N("取 消")]),_:1})]),_:1}),l(L,{span:4,offset:1},{default:d(()=>[l(F,{type:"primary",onClick:f},{default:d(()=>[N("确定")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),$i=Xe(Ei,[["__scopeId","data-v-45f31c70"]]),he=e=>(Le("data-v-2549f1d0"),e=e(),He(),e),Si={class:"upload-list"},Ii=he(()=>_("span",null,"请上传头像",-1)),Li=he(()=>_("span",null,"请上传 Banner 图",-1)),Hi={class:"upload-list",style:{"margin-top":"20px"}},Xi=he(()=>_("span",null,"请上传图片",-1)),Mi={class:"form-box"},Yi={class:"card"},Wi=he(()=>_("span",null,"请上传头像",-1)),Ti=he(()=>_("span",null,"请上传照片",-1)),Ri={class:"card"},Ai=he(()=>_("span",null,"请上传头像",-1)),Ui=he(()=>_("span",null,"请上传照片",-1)),Ni=G({__name:"uploadImg",setup(e){const s=M(""),t=M(""),i=M(""),o=M(""),a=M("https://img1.baidu.com/it/u=3859759748,2585219095&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1717520400&t=35e2f8898b6a2610aacf6ec0dc618dcb"),r=M(""),n=M(""),m=h=>{console.log(h)},g=M([{name:"img1",url:"https://img1.baidu.com/it/u=3859759748,2585219095&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1717520400&t=35e2f8898b6a2610aacf6ec0dc618dcb"},{name:"img1",url:"https://i.imgtg.com/2023/01/16/QRqMK.jpg"}]),C=zt({avatar:[{required:!0,message:"请上传用户头像"}],photo:[{required:!0,message:"请上传用户照片"}],username:[{required:!0,message:"请填写用户姓名"}]}),v=M({avatar:"",photo:[{name:"img",url:"https://img1.baidu.com/it/u=3859759748,2585219095&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1717520400&t=35e2f8898b6a2610aacf6ec0dc618dcb"}],username:""}),c=M({avatar:"",photo:[{name:"img",url:"https://img1.baidu.com/it/u=3859759748,2585219095&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1717520400&t=35e2f8898b6a2610aacf6ec0dc618dcb"}],username:"",idCard:"",email:""}),p=M(),x=()=>{p.value.validate(h=>{console.log(h)})};return(h,f)=>{const w=$i,b=oe("Avatar"),O=B,H=oe("Picture"),A=Jt,Q=ii,V=jt,U=Dt,ie=os,J=lt,z=qt,se=Ft;return E(),K(se,null,{default:d(()=>[l(A,{shadow:"never",header:"单图片上传"},{default:d(()=>[_("div",Si,[l(w,{"image-url":s.value,"onUpdate:imageUrl":[f[0]||(f[0]=y=>s.value=y),m],requestApi:u(ee),"file-size":3},{tip:d(()=>[N(" 上传图片最大为 3M ")]),_:1},8,["image-url","requestApi"]),l(w,{"image-url":t.value,"onUpdate:imageUrl":f[1]||(f[1]=y=>t.value=y),requestApi:u(ee),drag:!1,"border-radius":"50%"},{empty:d(()=>[l(O,null,{default:d(()=>[l(b)]),_:1}),Ii]),tip:d(()=>[N(" 圆形组件（禁止拖拽上传） ")]),_:1},8,["image-url","requestApi"]),l(w,{"image-url":i.value,"onUpdate:imageUrl":f[2]||(f[2]=y=>i.value=y),requestApi:u(ee),width:"250px"},{empty:d(()=>[l(O,null,{default:d(()=>[l(H)]),_:1}),Li]),tip:d(()=>[N(" 长方形组件（可拖拽上传） ")]),_:1},8,["image-url","requestApi"]),l(w,{"image-url":o.value,"onUpdate:imageUrl":f[3]||(f[3]=y=>o.value=y),requestApi:u(ee),disabled:""},{tip:d(()=>[N(" 无图（禁用上传） ")]),_:1},8,["image-url","requestApi"]),l(w,{"image-url":a.value,"onUpdate:imageUrl":f[4]||(f[4]=y=>a.value=y),requestApi:u(ee),disabled:""},{tip:d(()=>[N(" 有图（禁用编辑、删除） ")]),_:1},8,["image-url","requestApi"]),l(w,{"image-url":r.value,"onUpdate:imageUrl":[f[5]||(f[5]=y=>r.value=y),m],requestApi:u(ee),cropper:!0},{tip:d(()=>[N(" 启用图片裁剪 ")]),_:1},8,["image-url","requestApi"]),l(w,{"image-url":n.value,"onUpdate:imageUrl":[f[6]||(f[6]=y=>n.value=y),m],requestApi:u(ee),comporess:!0},{tip:d(()=>[N(" 上传前压缩图片 ")]),_:1},8,["image-url","requestApi"])])]),_:1}),l(A,{shadow:"never",header:"多图片上传",style:{"margin-top":"20px"}},{default:d(()=>[_("div",Hi,[l(Q,{"file-list":g.value,"onUpdate:fileList":f[7]||(f[7]=y=>g.value=y),requestApi:u(ee),width:"250px",sortable:!0},{empty:d(()=>[l(O,null,{default:d(()=>[l(H)]),_:1}),Xi]),tip:d(()=>[N(" 图片拖拽排序,拖拽上传 ")]),_:1},8,["file-list","requestApi"])])]),_:1}),_("div",Mi,[_("div",Yi,[l(V,{title:"图片上传组件在 form 表单中使用，上传之后成功会自动重新校验",type:"warning",effect:"dark",closable:!1}),l(z,{ref_key:"ruleFormRef",ref:p,"label-width":"100px","label-suffix":" :",rules:C,model:v.value},{default:d(()=>[l(U,{label:"用户头像",prop:"avatar"},{default:d(()=>[l(w,{"image-url":v.value.avatar,"onUpdate:imageUrl":f[8]||(f[8]=y=>v.value.avatar=y),requestApi:u(ee),width:"135px",height:"135px","file-size":3},{empty:d(()=>[l(O,null,{default:d(()=>[l(b)]),_:1}),Wi]),tip:d(()=>[N(" 头像大小不能超过 3M ")]),_:1},8,["image-url","requestApi"])]),_:1}),l(U,{label:"用户照片",prop:"photo"},{default:d(()=>[l(Q,{"file-list":v.value.photo,"onUpdate:fileList":f[9]||(f[9]=y=>v.value.photo=y),requestApi:u(ee),limit:3,height:"140px",width:"140px","border-radius":"50%"},{empty:d(()=>[l(O,null,{default:d(()=>[l(H)]),_:1}),Ti]),tip:d(()=>[N(" 最多上传 3 张照片 ")]),_:1},8,["file-list","requestApi"])]),_:1}),l(U,{label:"用户姓名",prop:"username"},{default:d(()=>[l(ie,{modelValue:v.value.username,"onUpdate:modelValue":f[10]||(f[10]=y=>v.value.username=y),placeholder:"请填写用户姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(U,null,{default:d(()=>[l(J,null,{default:d(()=>[N(" 取消 ")]),_:1}),l(J,{type:"primary",onClick:x},{default:d(()=>[N(" 确定 ")]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_("div",Ri,[l(V,{title:"图片上传组件在 form 表单中使用，如果该表单禁用，则上传组件会自动禁用",type:"warning",effect:"dark",closable:!1}),l(z,{"label-width":"100px","label-suffix":" :",disabled:"",model:c.value},{default:d(()=>[l(U,{label:"用户头像",prop:"avatar"},{default:d(()=>[l(w,{"image-url":c.value.avatar,"onUpdate:imageUrl":f[11]||(f[11]=y=>c.value.avatar=y),requestApi:u(ee),width:"135px",height:"135px","file-size":3},{empty:d(()=>[l(O,null,{default:d(()=>[l(b)]),_:1}),Ai]),tip:d(()=>[N(" 头像大小不能超过 3M ")]),_:1},8,["image-url","requestApi"])]),_:1}),l(U,{label:"用户照片",prop:"photo"},{default:d(()=>[l(Q,{"file-list":c.value.photo,"onUpdate:fileList":f[12]||(f[12]=y=>c.value.photo=y),requestApi:u(ee),limit:3,height:"140px",width:"140px","border-radius":"50%"},{empty:d(()=>[l(O,null,{default:d(()=>[l(H)]),_:1}),Ui]),tip:d(()=>[N(" 最多上传 3 张照片 ")]),_:1},8,["file-list","requestApi"])]),_:1}),l(U,{label:"用户姓名",prop:"username"},{default:d(()=>[l(ie,{modelValue:c.value.username,"onUpdate:modelValue":f[13]||(f[13]=y=>c.value.username=y),placeholder:"请填写用户姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(U,null,{default:d(()=>[l(J,null,{default:d(()=>[N(" 取消 ")]),_:1}),l(J,{type:"primary",onClick:x},{default:d(()=>[N(" 确定 ")]),_:1})]),_:1})]),_:1},8,["model"])])])]),_:1})}}}),Eo=Xe(Ni,[["__scopeId","data-v-2549f1d0"]]);export{Eo as default};
